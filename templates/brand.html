{% extends "base.html" %}

{% block title %}{{ brand.name }} Yedek Parça Fiyatları | Umay Oto Yedek Parça{% endblock %}
{% block meta_desc %}{{ brand.name }} yedek parça ürünleri: OEM kodu, uyumlu araç bilgisi ve hızlı WhatsApp iletişimi ile doğru parçayı kolayca bulun.{% endblock %}

{% block og_title %}{{ brand.name }} Yedek Parça | Umay Oto Yedek Parça{% endblock %}
{% block og_desc %}{{ brand.name }} yedek parça ürünleri: OEM kodu ve uyumluluk bilgisiyle aradığınız parçayı bulun, WhatsApp’tan hızlıca sorun.{% endblock %}

{% block content %}

{# Breadcrumb #}
<nav class="breadcrumb" aria-label="breadcrumb">
  <a href="{% url 'home' %}">Ana Sayfa</a>
  <span aria-hidden="true">›</span>
  <span aria-current="page">{{ brand.name }} Yedek Parça</span>
</nav>

<header class="page-header">
  <h1 class="page-title">{{ brand.name }} Yedek Parça</h1>
</header>

<form class="search" method="get" action="{% url 'all_products' %}" role="search" aria-label="Ürün arama">
  <input
    name="q"
    placeholder="OEM / ürün / araç ara…"
    value="{{ q|default:request.GET.q|default:'' }}"
    inputmode="search"
    autocomplete="off"
  >
  <button type="submit">Ara</button>
</form>

<section class="product-grid" aria-label="{{ brand.name }} ürünleri">
  {% for p in products %}
    <article class="product-card" itemscope itemtype="https://schema.org/Product">
      <a href="{% url 'product_detail' p.slug %}" itemprop="url" aria-label="{{ p.name }}">
        {% if p.image %}
          <img src="{{ p.image.url }}" alt="{{ p.name }}" loading="lazy" itemprop="image">
        {% endif %}
        <h2 itemprop="name">{{ p.name }}</h2>
      </a>

      <div class="meta">
        <span>{{ p.category.name }}</span>{% if p.oem_code %} · <span>OEM: {{ p.oem_code }}</span>{% endif %}
      </div>

      {% if p.short_desc %}
        <p class="desc" itemprop="description">{{ p.short_desc|truncatechars:120 }}</p>
      {% endif %}

      {# WhatsApp Butonu (SITE_URL ile absolute link) #}
      {% with product_url=SITE_URL|add:p.get_absolute_url %}
        <a class="buy"
           target="_blank"
           rel="nofollow noopener noreferrer"
           href="https://wa.me/{{ BUSINESS_WHATSAPP }}?text={{ 'Merhaba, şu ürün hakkında bilgi almak istiyorum: '|add:p.name|add:' '|add:product_url|urlencode }}">
          WhatsApp ile Sor
        </a>
      {% endwith %}
    </article>
  {% empty %}
    <p>Bu marka için henüz ürün eklenmedi.</p>
  {% endfor %}
</section>

{# Pagination (production-ready) #}
{% if page_obj and page_obj.paginator.num_pages > 1 %}
<nav class="pagination" aria-label="Sayfalama">
  {% if page_obj.has_previous %}
    <a href="?page={{ page_obj.previous_page_number }}{% if q %}&q={{ q|urlencode }}{% endif %}" rel="prev">‹ Önceki</a>
  {% endif %}

  <span>Sayfa {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}</span>

  {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}{% if q %}&q={{ q|urlencode }}{% endif %}" rel="next">Sonraki ›</a>
  {% endif %}
</nav>
{% endif %}

{# SEO içerik bloğu (sayfanın altı) #}
<section class="seo-content">
  <h2>{{ brand.name }} Yedek Parça</h2>
  <p>
    {{ brand.name }} araçlar için yedek parça ararken OEM/parça kodu ve uyumluluk bilgisi en önemli kriterlerdendir.
    Bu sayfada {{ brand.name }} markasına ait parçaları listeleyebilir, ürün detaylarında OEM kodu ve uyumlu araç bilgisini kontrol edebilirsiniz.
    Doğru ürünü seçmek için WhatsApp üzerinden hızlıca bilgi alabilirsiniz.
  </p>
</section>

{# LocalBusiness JSON-LD (marka sayfası için site genel işletme bilgisi) #}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "AutoPartsStore",
  "name": "{{ BUSINESS_NAME }}",
  "url": "{{ SITE_URL }}",
  "telephone": "{{ BUSINESS_PHONE }}",
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "{{ BUSINESS_ADDRESS }}"
  }
}
</script>

{% endblock %}
